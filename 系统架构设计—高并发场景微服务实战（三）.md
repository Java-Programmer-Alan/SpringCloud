# 系统架构设计—高并发场景微服务实战（三）

你好，我是程序员Alan。

在《需求分析— 高并发场景微服务实战（二）》一文中，我详细梳理了业务需求。相信你对订票系统的业务需求情况已经十分清楚了。下面我开始系统设计工作，包括功能模块设计、存储设计、缓存设计、高并发系统架构设计等，为后面的开发工作提供良好的基础保障。

## 存储设计

微服务架构风格的一个好处，是持久性的封装。我们可以根据每个服务的需要，去选择不同的持久化技术。根据每种数据类型的特点而去选择数据存储的方法，也就是混合持久化，结构化存储与非结构化存储混合使用。不同服务间使用不同的存储模型，单一服务中也可以使用混合存储。既然要采用微服务化结构，从独立开发、运行、部署和运维都是单独的小应用。每个小应用内部业务逻辑处理，到数据库访问，以及数据库都是独立的。  

依据本案例的业务场景，拆分为七个子存储库，分别为：  

- airline_member——用户服务库
- airline_ticket_resource——机票资源服务库
- airline_charging——计费服务库
- airline_finance——财务服务库
- airline_message——消息服务库
- airline_log——日志服务库

实际中有些实施微服务的团队，将服务拆分，但存储库依旧仍是一份，现实中应该有为数不少的存在。不能说不对，只能说不符合微服务的建议。  

## 架构设计

 没有最优的架构，只有最合适的架构，一切系统设计原则都要以解决业务问题为最终目标，并随着业务的发展，不断进行迭代演进。经过上面业务模块、存储模型的划分，基本的代码架构已经清晰可见。综合业务模块、微服务架构特性，输出功能架构设计图。  

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/26323281/1664506441602-2edeca99-2db6-46c2-9f7d-fa1e9fe0609c.jpeg)

工具集合

 基于总体功能架构图，使用特定的功能组件即可实现相应的功能。

![img](https://cdn.nlark.com/yuque/0/2022/jpeg/26323281/1664506454628-e30ebda1-e9a1-4ab4-8797-4e19e030fa93.jpeg)

## 留些问题

- 存储层的数据库的表结构（数据类型和索引）如何设计？
-  当数据库成为瓶颈后，动态数据的查询如何使用缓存加速？  
- 系统架构设计为什么要分层?

## 站在巨人的肩膀上：

- 码闻强—SpringCloud微服务实战

**如果对您有帮助，欢迎关注我的微信公众号和我交流：ProgrammerAlan**
